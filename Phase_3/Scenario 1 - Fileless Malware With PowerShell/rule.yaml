name: Fileless Malware - Remote PowerShell Execution
type: any

index: winlogbeat-*

filter:
- query:
    query_string:
      query: 'event.code:1 AND process.command_line:*powershell* AND process.command_line:*Invoke-WebRequest*'

alert:
- email

email:
- your_email@example.com

alert_subject: "⚠️ Suspicious PowerShell Fileless Execution Detected"
alert_text: |
  Fileless malware attack detected via PowerShell remote script execution.
  Host: {0}
  Command Line: {1}

alert_text_args:
- host.name
- process.command_line

timestamp_field: "@timestamp"
